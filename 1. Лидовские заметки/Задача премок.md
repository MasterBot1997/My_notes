
---

Задача: 
> Нужно посчитать статистику, в которой подсчитывается, сколько постов от пользователя поступило после того, как сапортер ответил. Для каждого отдельного сотрудника

---

Получение всех сапортят из БД:
```
"SELECT      id, name, login, rank, support_lvl, support_lvl_default from workers where rank='support' AND  support_lvl_default='vps';"
```

Получение данных по тикету: 
```

```

---
Подзадачи:
1. Понять как получить нужных сапортят - done
2. Понять, как получить список тикетов переданных на Cloud.
3. Понять как считать кол-во ответов после первого ответа сопортенка Cloud (понять через сколько ответов завершился тикет)
4. Понять как считать кол-во постов после ответа имсенно сапортоенка vps 
5. разбить статистику по кол-ву постов после ответа на посты через 3, 6, 12 часов.

> Идеальный мир сделать борду



# 1. Получение  нужных сапортят линии Cloud
Получить список сапортят vps можно так:
```
mybeget_main -e 'select id, post, state, name, login, rank, support_lvl, support_lvl_default from workers where state="working" and rank="support" and support_lvl_default="vps" and post like "Инженер технической поддержки%" ;
```
Пример вывода:
```
(support-console) ibelyaev@support-console-warp:~ [0] $ mybeget_main -e 'select id, post, state, name, login, rank, support_lvl, support_lvl_default from workers where state="working" and rank="support" and support_lvl_default="vps" and post like "Инженер технической поддержки%" ;'
mysql: [Warning] Using a password on the command line interface can be insecure.
+-----+--------------------------------------------------------------------------+---------+------------------------------------------------------+-------------+---------+-------------+---------------------+
| id  | post                                                                     | state   | name                                                 | login       | rank    | support_lvl | support_lvl_default |
+-----+--------------------------------------------------------------------------+---------+------------------------------------------------------+-------------+---------+-------------+---------------------+
| 345 | Инженер технической поддержки (VPS)                                      | working | Тимофеева Ольга Витальевна                           | otimofeeva  | support | vps         | vps                 |
| 705 | Инженер технической поддержки (VPS)                                      | working | Митрофанов Михаил Юрьевич                            | mmitrofanov | support | vps         | vps                 |
| 763 | Инженер технической поддержки (VPS)                                      | working | Иванников Михаил Евгеньевич                          | mivannikov  | support | vps         | vps                 |
| 868 | Инженер технической поддержки (VPS)                                      | working | Иванов Антон Алексеевич                              | anivanov    | support | vps         | vps                 |
| 909 | Инженер технической поддержки (VPS)(ВРИО)                                | working | Гарбуз Валерий Павлович                              | vgarbuz     | support | vps         | vps                 |
| 927 | Инженер технической поддержки (VPS)                                      | working | Волков Артём Юрьевич                                 | avolkov     | support | vps         | vps                 |
+-----+--------------------------------------------------------------------------+---------+------------------------------------------------------+-------------+---------+-------------+---------------------+
```
Варик с минимизацией инфы:
```
mybeget_main -e 'select id, login from workers where state="working" and rank="support" and support_lvl_default="vps" and post like "Инженер технической поддержки%";'
mysql: [Warning] Using a password on the command line interface can be insecure.
+-----+-------------+
| id  | login       |
+-----+-------------+
| 345 | otimofeeva  |
| 705 | mmitrofanov |
| 763 | mivannikov  |
| 868 | anivanov    |
| 909 | vgarbuz     |
| 927 | avolkov     |
+-----+-------------+
```


# 2. Получение списка тикетов переданных на Cloud.

Что бы получить id тикета и поста, по идее мне нужно ловить в таблице journal передачу, она выглядит примерно так:
```
(support-console) ibelyaev@support-console-warp:~ [0] $ myhelp -e 'select * from journal where ticket_id="2629831";'
mysql: [Warning] Using a password on the command line interface can be insecure.
+----------+-------------+-----------+------------------------------------------------------------------+----------+-------------------------------------------------------------------+------------------------------------------------------------------+---------------------+
| id       | employee_id | ticket_id | author                                                           | property | old_value                                                         | new_value                                                        | created_at          |
+----------+-------------+-----------+------------------------------------------------------------------+----------+-------------------------------------------------------------------+------------------------------------------------------------------+---------------------+
| 16022646 |         716 |   2629831 | VM support                                                       | assignee | NULL                                                              | Дьягольченко Андрей Александрович                                | 2025-07-24 09:57:24 |
| 16022669 |         988 |   2629831 | Дьягольченко Андрей Александрович                                | move     | Техническая поддержка:Первая линия                                | Cloud:Вторая линия                                               | 2025-07-24 10:01:25 |
| 16022796 |         345 |   2629831 | Тимофеева Ольга Витальевна                                       | assignee | NULL                                                              | Тимофеева Ольга Витальевна                                       | 2025-07-24 10:12:42 |
| 16022973 |         345 |   2629831 | Тимофеева Ольга Витальевна                                       | status   | wip                                                               | feedback                                                         | 2025-07-24 10:35:08 |
| 16023328 |        NULL |   2629831 | NULL                                                             | status   | feedback                                                          | open                                                             | 2025-07-24 11:18:44 |
| 16023334 |         716 |   2629831 | VM support                                                       | assignee | NULL                                                              | VM support                                                       | 2025-07-24 11:19:02 |
| 16023336 |         716 |   2629831 | VM support                                                       | move     | Техническая поддержка:Первая линия                                | Cloud:Вторая линия                                               | 2025-07-24 11:19:04 |
+----------+-------------+-----------+------------------------------------------------------------------+----------+-------------------------------------------------------------------+------------------------------------------------------------------+---------------------+
```
Тут в виде автора `NULL` это кастомер. В Целом поймать все тикеты, которые переданы на VPS можно так:
```
myhelp -e 'select id, employee_id, author, ticket_id, property, new_value, created_at  from journal where property="move" and new_value="Cloud:Вторая линия" and created_at >= "2025-07-01 00:00:00" and created_at <  "2025-07-08 00:00:00" ORDER BY created_at ASC;'
```



Структура таблицы:
```
(support-console) ibelyaev@support-console-warp:~ [0] $ myhelp -e 'select * from post limit 1;'
mysql: [Warning] Using a password on the command line interface can be insecure.
+----+-------------+-----------+----------+----------------------------------------------+------------------------------------------------+-------------------+----------------+------------------------+----------+---------------------+---------------------+-------------+------------+-------------+
| id | employee_id | ticket_id | queue_id | author                                       | text                                           | employee_position | employee_level | employee_default_level | metadata | updated_at          | created_at          | remote_addr | user_agent | is_markdown |
+----+-------------+-----------+----------+----------------------------------------------+------------------------------------------------+-------------------+----------------+------------------------+----------+---------------------+---------------------+-------------+------------+-------------+
| 17 |           0 |        14 |     NULL | Маникин Алексей Юрьевич                      | Тест   Тестовое сообщение                      | NULL              | NULL           | NULL                   | NULL     | 2018-05-11 09:07:55 | 2009-07-31 22:45:51 |             |            |           0 |
+----+-------------+-----------+----------+----------------------------------------------+------------------------------------------------+-------------------+----------------+------------------------+----------+---------------------+---------------------+-------------+------------+-------------+
```
Мне по идее нужны только посты, в post так:
```
myhelp -e 'select ticket_id, author, updated_at, created_at from post where ticket_id="2629831"'
+-----------+------------------------------------------------------------------+---------------------+---------------------+
| ticket_id | author                                                           | updated_at          | created_at          |
+-----------+------------------------------------------------------------------+---------------------+---------------------+
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 09:51:44 | 2025-07-24 09:51:44 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 10:45:14 | 2025-07-24 09:57:14 |
|   2629831 | Дьягольченко Андрей Александрович                                | 2025-07-24 10:01:23 | 2025-07-24 10:01:23 |
|   2629831 | Тимофеева Ольга Витальевна                                       | 2025-07-24 10:35:02 | 2025-07-24 10:35:02 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 11:35:38 | 2025-07-24 11:18:44 |
|   2629831 | Беляев Иван Романович                                            | 2025-07-24 11:35:39 | 2025-07-24 11:35:39 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 13:34:51 | 2025-07-24 12:36:40 |
|   2629831 | Тимофеева Ольга Витальевна                                       | 2025-07-24 13:34:52 | 2025-07-24 13:34:52 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 13:51:40 | 2025-07-24 13:42:25 |
|   2629831 | Тимофеева Ольга Витальевна                                       | 2025-07-24 13:51:42 | 2025-07-24 13:51:42 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 14:00:30 | 2025-07-24 13:51:48 |
|   2629831 | Тимофеева Ольга Витальевна                                       | 2025-07-24 14:02:15 | 2025-07-24 14:02:15 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 14:22:24 | 2025-07-24 14:07:25 |
|   2629831 | Тимофеева Ольга Витальевна                                       | 2025-07-24 14:22:26 | 2025-07-24 14:22:26 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 14:37:13 | 2025-07-24 14:37:13 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 14:43:49 | 2025-07-24 14:43:49 |
|   2629831 | Сбитенков Владимир Владимирович                                  | 2025-07-24 14:58:59 | 2025-07-24 14:48:32 |
|   2629831 | Тимофеева Ольга Витальевна                                       | 2025-07-24 14:59:00 | 2025-07-24 14:59:00 |
+-----------+------------------------------------------------------------------+---------------------+---------------------+
```
Вот так берем, что бы получить колонку с параметрм, что это не пользователь:
```
myhelp -e 'select id, ticket_id, employee_id, author, created_at from post where ticket_id="2629831"'
```

