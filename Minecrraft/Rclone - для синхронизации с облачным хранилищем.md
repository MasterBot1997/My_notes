
**Rclone** — это мощный инструмент для синхронизации и управления файлами в облачных хранилищах, таких как Google Drive, Dropbox, OneDrive и другие. Его можно использовать для автоматического создания резервных копий Minecraft-сервера в облако.

Вот пошаговое руководство по настройке **Rclone** для синхронизации с облачным хранилищем (например, Google Drive) и автоматизации процесса резервного копирования Minecraft-сервера.

### Шаг 1: Установка Rclone

#### Для Linux:
1. Откройте терминал и выполните следующую команду для установки:
   ```bash
   curl https://rclone.org/install.sh | sudo bash
   ```
2. После установки убедитесь, что rclone установлен правильно:
   ```bash
   rclone version
   ```

#### Для Windows:
1. Перейдите на официальный сайт **Rclone**: [rclone.org/downloads](https://rclone.org/downloads/) и скачайте версию для Windows.
2. Распакуйте архив в удобное место, затем добавьте путь к **rclone.exe** в **Переменные среды** для удобного использования из командной строки:
   - Откройте свойства системы (ПКМ на "Этот компьютер" → "Свойства" → "Дополнительные параметры системы").
   - Выберите **Переменные среды** → в разделе **Системные переменные** найдите строку **Path** → нажмите "Изменить" → добавьте путь к папке, где находится **rclone.exe**.

3. Проверьте установку:
   Откройте командную строку и выполните:
   ```cmd
   rclone version
   ```

### Шаг 2: Настройка Rclone с Google Drive

#### 1. Создание нового подключения

1. Выполните команду в терминале (или командной строке):
   ```bash
   rclone config
   ```
   
2. Появится интерфейс конфигурации. Выберите действие:
   - Введите **`n`**, чтобы создать новое удаленное соединение (remote).
   
3. Дайте имя вашему новому подключению, например, **`gdrive`**:
   ```
   name> gdrive
   ```

4. Выберите тип облачного хранилища:
   - Найдите в списке и выберите Google Drive, введя соответствующий номер (обычно **16**):
   ```
   Storage> 16
   ```

5. Оставьте клиентский ID и секрет пустыми (по умолчанию):
   ```
   client_id> [оставьте пустым и нажмите Enter]
   client_secret> [оставьте пустым и нажмите Enter]
   ```

6. Выберите вариант авторизации:
   - Выберите **`1`**, чтобы использовать свой аккаунт Google для авторизации.
   ```
   scope> 1
   ```

7. Автоматическое создание API токена:
   - Укажите **`y`**, чтобы rclone автоматически настроил доступ через браузер:
   ```
   Use auto config? > y
   ```
   
8. После этого откроется браузер с запросом доступа к вашему Google аккаунту. Разрешите доступ, и после этого rclone сгенерирует токен для подключения к Google Drive.

9. Когда вы вернетесь в консоль, rclone попросит подтвердить сохранение конфигурации. Введите **`y`**, чтобы сохранить настройки.

#### 2. Проверка подключения

Чтобы убедиться, что rclone правильно настроен, выполните команду:
```bash
rclone ls gdrive:
```
Эта команда должна показать список файлов и папок на вашем Google Drive.

### Шаг 3: Резервное копирование Minecraft-сервера с помощью Rclone

Теперь, когда rclone настроен, вы можете синхронизировать или загружать резервные копии сервера на Google Drive.

#### 1. Ручная синхронизация

Для создания резервной копии папки с вашим Minecraft-сервером используйте команду:

```bash
rclone sync /путь/к/папке/с/сервером gdrive:/MinecraftBackup
```

- **`/путь/к/папке/с/сервером`** — это путь к папке, где находится ваш сервер Minecraft (например, `/home/minecraft/server` или `C:\minecraft-server`).
- **`gdrive:/MinecraftBackup`** — это папка на Google Drive, куда будут загружены резервные копии. Rclone автоматически создаст папку **MinecraftBackup**, если она не существует.

Пример для Linux:
```bash
rclone sync /home/minecraft/server gdrive:/MinecraftBackup
```

Пример для Windows:
```cmd
rclone sync C:\minecraft-server gdrive:/MinecraftBackup
```

#### 2. Автоматизация резервного копирования

Чтобы автоматизировать процесс резервного копирования, можно использовать планировщик задач в зависимости от операционной системы.

##### **Для Linux** (cron):
1. Откройте cron для редактирования:
   ```bash
   crontab -e
   ```

2. Добавьте задание для автоматического выполнения каждый день в 3:00 ночи:
   ```bash
   0 3 * * * rclone sync /home/minecraft/server gdrive:/MinecraftBackup
   ```

##### **Для Windows** (Task Scheduler):
1. Откройте **Планировщик задач**.
2. Создайте новую задачу и выберите время, когда она будет запускаться (например, каждый день в 3:00).
3. В поле программы укажите путь к **rclone.exe**, а в аргументах — команду для синхронизации:
   ```cmd
   sync C:\minecraft-server gdrive:/MinecraftBackup
   ```

### Шаг 4: Дополнительные параметры и советы

- **Добавление флага `--backup-dir`**:
   Если вы хотите сохранять старые версии файлов, а не заменять их, можно использовать опцию `--backup-dir`:
   ```bash
   rclone sync /home/minecraft/server gdrive:/MinecraftBackup --backup-dir gdrive:/OldBackups/$(date +\%Y\%m\%d)
   ```
   Этот флаг переместит старые версии файлов в указанную папку (например, `OldBackups`), создавая там подпапку с датой резервного копирования.

- **Шифрование данных**:
   Если вам нужно обеспечить конфиденциальность данных, rclone поддерживает шифрование файлов перед их загрузкой в облако. Это можно настроить с помощью **rclone crypt**.

- **Лимиты Google Drive**:
   Помните, что Google Drive может ограничивать объем загрузки данных в течение дня. Если у вас большой мир Minecraft, будьте внимательны к лимитам на передачу данных.

### Заключение

Теперь вы настроили **rclone** для создания резервных копий вашего Minecraft-сервера в Google Drive. Автоматизация процесса с помощью **cron** или **Task Scheduler** позволяет вам легко управлять резервными копиями и защищать свой сервер от потери данных.